import os
from pyPdf import PdfFileReader

'''
If something screws up, we return empty string.
TODO:
# add more doc formats like html, rtf, openoffice etc
# handle all exceptions
# make sure we have doc or pdf headers to prevent storing of malformed input
# warning: all file handlers are django file objects, not python file objects.
badri.dilbert@gmail.com
'''

class InvalidFileExtension(Exception):
    def __init__(self, fileName, extension):
        self.fileName = fileName
        self.extension = extension

def extractText(f):
	'generic function which will call appropriate extractor depending on file ext.'
        fileName, ext = os.path.splitext(f.name)
        if ext == '.pdf':
                return extractTextFromPdf(f)
        elif ext == '.doc':
                return extractTextFromDoc(f)
        elif ext == '.txt':
                return extractTextFromTxt(f)
        else:
                raise InvalidFileExtension(f.name, ext)


def extractTextFromPdf(f):
	'uses pyPdf and extracts text from pdf file.'
	# must handle exceptions
	inp = PdfFileReader(file(f.name,'rb'))
	str = ''
	for each_page in range(inp.getNumPages()):
		str += inp.getPage(each_page).extractText()
	return str		

def extractTextFromDoc(f):
	'''
	MS word files are converted to txt by using antiword program. works for most cases.
	'''
	str = os.popen("antiword "+ f).read()
	# process p
	return str

def extractTextFromTxt(f):
	'plain txt files.'
	#inputf = open(f)
	#str = inputf.read()
	#inputf.close()
	#return str
        from tempfile import NamedTemporaryFile
        destination = NamedTemporaryFile()
        destination.write(f.read())
        import codecs
        str = codecs.open(destination.name, 'r', 'utf-8', 'ignore')
        return str.read()


tests = r"""
>>> from utils.fileFilter import *
>>> from django.core.files import File
>>> f=File(open('foo.pdf', 'rb'))
>>> f
<File: foo.pdf>
>>> extractTextFromPdf(f)
u'DSC2001Proceedingsofthe2ndInternationalWorkshoponDistributedStatisticalComputingMarch15-17,Vienna,Austriahttp://www.ci.tuwien.ac.at/Conferences/DSC-2001K.Hornik&F.Leisch(eds.)ISSN1609-395XOctave:Past,Present,andFutureJohnW.EatonDepartmentofChemicalEngineeringUniversityofWisconsin-MadisonMadison,WIUSA53706AbstractThispaperoutlinesthehistoryanddevelopmentofGNUOctave,aninter-preterforahigh-levelmatrix-basedlanguagefornumericalcomputations.Anumberofundesirablefeaturesofthecurrentimplementationareexamined,andproposalsforfuturedevelopmentarepresented.1IntroductionGNUOctaveisahigh-levelmatrix-basedlanguage,primarilyintendedfornumericalcomputations.Itprovidesaconvenientcommandlineinterfaceforsolvinglinearandnonlinearproblemsnumerically,andforperformingothernumericalexperimentsusingalanguagethatismostlycompatiblewithMatlab.1Itmayalsobeusedasabatch-orientedlanguage.Octaveincludesacollectionoftoolsforsolvingcommonnumericallinearalgebraproblems,therootsofnonlinearequations,integratingordinaryfunctions,manipulatingpolynomials,andintegratingordinarytialandtial-algebraicequations.Itiseasilyextensibleandcustomizableviafunc-tionswritteninOctave\'sownlanguage,orusingdynamically-loadedmoduleswrit-teninC++,C,Fortran,orotherlanguages.OctaveisfreesoftwaredistributedunderthetermsoftheGNUGeneralPub-licLicense(GPL)aspublishedbytheFreeSoftwareFoundation(FSF).Sources,jwe@bevo.che.wisc.edu1MatlabisaregisteredtrademarkoftheMathWorks,Inc.ProceedingsofDSC20012mailinglistarchives,andotherinformationareavailableonthewebathttp://www.octave.org.JohnW.EatonistheprimaryauthorofOctave,thoughmanyothershavecon-tributedtamountsofcode,documentation,ideas,and(ofcourse)bugreports.AmongthelargercontributionsarethestatisticsfunctionswrittenbyKurtHornikandhisstudentsatTechnischeUnivatWienandthelinearcon-trolsystemsfunctionswrittenbyScottedwardHodelandhisstudentsatAuburnUniversity.Muchofthebasicnumericalcapabilitiesarebasedonwell-knownFor-tranlibrariessuchasODEPACK[6],DASSL[11],MINPACK[9],LAPACK[1],andtheBLAS[7,3,2].OctavealsoreliesonBisonandFlex(theGNUparsergeneratortools),theGNUReadlinelibrary(forcommand-lineeditingandhistory),andtheKpathsearchlibrary(forquicklyinlargedirectorytrees).Octavewasoriginallyconceived(inabout1988)tobecompanionsoftwareforanundergraduate-leveltextbookonchemicalreactordesignbeingwrittenbyJamesB.RawlingsoftheUniversityofWisconsin-MadisonandJohnG.EkerdtoftheUni-versityofTexas.Weoriginallyenvisionedsomespecializedtoolsforthesolutionofchemicalreactordesignproblems,probablyintheformofasubroutinelibraryinFortran.However,wehadoftenseenstudentsstrugglewithFortranprogrammingassignmentsandspendfartoomuchtimetryingtounderstandwhytheirFortrancodefailedandnotenoughtimelearningaboutchemicalengineering.Theseexpe-riencesmotivatedustoattempttobuildamuchmoretool.WebelievedthatwithaninteractiveenvironmentlikeOctave,moststudentswouldbeabletopickupthebasicsquickly,andbeginusingittlyinjustafewhours.WeweresomewhatfamiliarwithMatlab,havingseentheoriginalFortranversionaroundthesametimethatwewerebeginningtothinkaboutsoftwaretoolsforchemicalreactordesign.Additionally,agrowingnumberofourcolleagueswerebeginningtousethenewcommercialversionofMatlabastheirprimarycomputationaltool.WeeventuallydecidedtoimplementsomethingthatwouldbemostlyMatlab-compatiblesothatourcolleaguescouldswitchtousingOctavewithouthavingtolearnacompletelynewlanguage.AlthoughwechosetoimplementanearlyMatlab-compatiblelanguage,wedidnotwanttolimitourselvesstrictlytothatlanguage.Fromthebeginningoftheproject,weplannedtoaddvariousadditionalfeaturestothelanguageandhopedtobeabletothosethingsthatwebelievedweremisfeaturesofthelanguageorjustsimplybugs.Nowitseemsthatthegoalof\\compatibilityatareasonablecost"hascausedmanyproblemsfortheproject,aswewillseeindetailinSection4.Full-timedevelopmentbeganintheSpringof1992.ThealphareleasewasJanuary4,1993,andversion1.0wasreleasedFebruary17,1994.Sincethen,Octavehasbeenthroughseveralmajorrevisions,isincludedwithDebian,SuSE,andRedHatLinuxdistributions.IthasalsobeenreviewedintheLinuxJournal[10]andtheJournalofAppliedEconometrics[4].ThenextsectionincludesamorecompletehistoryofOctave\'sdevelopment.Clearly,Octaveisnowmuchmorethanjustanother\\courseware"packagewithlimitedutilitybeyondtheclassroom.Althoughourinitialgoalsweresomewhatvague,weknewthatwewantedtocreatesomethingthatwouldenablestudentstosolverealisticproblems,andthattheycoulduseformanythingsotherthanProceedingsofDSC20013chemicalreactordesignproblems.Today,thousandsofpeopleworldwideareusingOctaveinteaching,research,andcommercialapplications.BecauseOctavemaybefreelydistributed,itistoestimatethetotalnumberofpeoplewhouseit.ThereareatleastfourmirrorsoftheOctaveFTPsite,andtheOctavesourcesarealsoavailablefromtheGNUFTPsiteandallofitsmirrors(morethan75advertisedsitesatlastcount).TheFTPlogsfromoursystemaloneshowedmorethan19,000transfersoftheOctavesourceinthe950daysthatOctave2.0.xwasavailable.ManyLinuxusersreceiveOctaveinbinaryformaswell.NoonereallyknowshowmanypeopleusingLinuxarealsousingOctave,butsomerecentestimatesplacethenumberofLinuxusersatmorethan20million.JustabouteveryonethinksthatthenameOctavehassomethingtodowithmusic,butitisactuallythenameofoneoftheauthor\'sformerprofessorswhowroteafamoustextbook[8]onchemicalreactionengineering,andwhowasalsowellknownforhisabilitytodoquick\\backoftheenvelope"calculations.2DevelopmentHistoryIbeganworkingontheinterpreterforOctaveonFebruary20,1992whileIwasstillmyPh.D.thesisattheUniversityofTexas.IhadbeenexperimentingwithsomeC++classesfornumericalproblemsforaboutayearbeforethat,butOctavewouldbemyrealprojectinC++.TheearlyentriesintheChangeLogshowthatprogresswasrapid,andbyearlyJuly,Octavewasabletosolvesomesimpletialequations.BySeptember,severalothermembersofmyresearchgroupbegantryingtouseit(andlotsofbugs).OnJanuary4,1993,ImadeOctaveavailableforanonymousFTPandpostedanannouncementtoseveralUsenetgroups.Bythistime,Octaveincludedabout100built-infunctionsand30functionandcouldhandlemostoftheoperatorsavailableinthethencurrentversionofMatlab.Duringthisyear,Iwastheonlypersonwhohaddoneanyprogrammingontheproject.Today,itishardtoimagineafreesoftwareprojectintendedforwidespreadusethatwouldbedevelopedinsuchisolation.Aftertherelease,Ibegantoreceivefeedbackalmostimmediately,andIwasencouragedbythelevelofinterest.IcontinuedtoputnewtestreleasesontheFTPsiteforaboutanotheryear,butmadenomoreannouncementsoutsideoftheOctavemailinglistsuntilversion1.0wasreleasedonFebruary17,1994.Duringthenextyear,manypeoplereportedbugsandrequestedfeatures,andsomesentpatchesornewfunctions.Iperiodicallymadesnapshotsavailable,butthenextpublicrelease(version1.1.0)wasnotmadeuntilJanuary12,1995.Developmentwasinterruptedinmid-1995asourresearchgroupmovedfromTexastoWisconsin.MuchofmyworkonOctaveoverthenextyearfocusedoncleaninguptheinternals(pluggingmemoryleaks,tryingtouseC++moreely,etc.),addingnewfunctions,andmakingOctavereadyforanewrelease.Octavehadgainedtcapabilitybythetimeversion2.0wasreleasedonDecember10,1996.ProceedingsofDSC20014Forthenextseveralmonths,Iworkedmostlytobugs,releasingversions2.0.1through2.0.5infairlyquicksuccession.Ihadhopedtoquicklyreachamostlybug-freestatesothatIcouldbeginconcentratingonversion2.1andaddingtnewfeatures,butthatneverseemedtohappen.Eventually,IdecidedtofollowtheleadoftheLinuxkerneldeveloperswhohadoptedforstableandunstabledevelopmentbranches,andIsplitthe2.1.xsourcessometimeinmid-1997andbeganmakingperiodicreleasesfromboththedevelopmentandstablebranches.Theideawastospeeduptheincorporationofnewideasintheunstablebranchwhilemaintainingtheotherbranchforbugonly,butIfoundittodenyusefulnewfeaturestotheusersofthestableversion,soIoftenspentextratimepatchingthestablesourcestoincludenewfeatures.Toavoidwastingtimelikethisinthefuture,Iwouldonlyattempttohavetwoactivelymaintaineddevelopmenttreesifanotherindividual(orgroup)wereavailabletomaintainthestablebranchwhileIworkwiththedevelopmentsources(I\'vetriedtovolunteersforthistask,butsofar,noonehassteppedforward).InMayof1997,RichardStallmanandIagreedtomakeOctaveanpartoftheGNUproject(theonlyrealchangewasthatIbegancallingit\\GNUOctave"ratherthanjust\\Octave").Byearly1999,manyfreesoftwareprojectsbegantobeavailablebyanonymousCVS,andinresponsetosomediscussionontheOctavemailinglists,Imadearead-onlycopyoftheOctaveCVSarchiveavailable.TheideawasthatthiswouldhelptospeedupOctavedevelopmentbyallowingpeopletoseetheirchangesinthesourcetreequickly,withouthavingtowaitforanewsnapshot.IbelievethatEricRaymond\'spaper,TheCathedralandtheBazaar[12]convincedmanypeoplethatanopendevelopmentmodelwasthekeytorapiddevelopment,butIdon\'tbelieveitisthatsimple.Wide-openavailabilityofsourcecodedoesn\'tmeanmuchwithoutadedicatedgroupofhackerswhoaregenerallyalignedtowardacommongoal.Atthetimeofthiswriting,Octaveisausefulandwidelyusedtoolfornumericalcomputing.Aswithanysizeablepieceofsoftware,however,therearemanyareasforimprovement.Ibelievethereareproblemswiththelanguagethatshouldbe(anumberoftheseareexaminedinthenextsection).Octavealsolacksafewimportantdatatypessuchassparsematricesandmultidimensionalmatrices.SomeuserswouldbfromaversionofOctavethatcouldeasilysupportparallelprocessing.Otherswouldliketoseemoreadvancedgraphicsandgraphicaluserinterface(GUI)features.And,ofcourse,manyusersrequestimprovedcompatibilitywithMatlab(wewillexaminethistopicinmoredetailinSection4).OnDecember7,2000,IannouncedtotheOctavemailinglistthatIamplanningtotakeabreakfromOctave,reviewtheprogresswehavemade,anddecidewhatisthebestcourseforthefuture.ThatmayinvolvesomederivativeofOctave,oritmaybesomethingthatisonlylooselyrelated.IfitisasystembasedonOctave,thenIwouldlikeforittoavoidmanyoftheproblemsdescribedinthenextsection.ProceedingsofDSC200153DesignandImplementationInthefollowingsections,variousfeaturesofOctaveareexamined.SomeareworthnotingbecausetheyarevaluablefeaturesthatshouldprobablybekeptinanyfutureOctavederivatives,andothersarementionedbecausetheyarethetroublespotsthatshouldberemoved.Insomecases,thetroublesomefeaturesarequitepopularwithformerMatlabusers,soIhavetriedtopresentclearargumentsforwhythesefeaturesarereallynotsogoodafterall.AlthoughIwouldliketobeabletosaythatallofthebadfeaturesofOctavewereinheritedfromMatlab,Imustadmitthatquiteafewofthemaremyowninvention.3.1FreesoftwareOneofOctave\'smostimportantfeaturesisthatitisfreesoftware.Allofthesourcecodeisavailable,sousersareabletoexamineexactlyhoweachcomputationisperformed.Thereareno\\black-boxes"thatcannotbeopened.UsersarealsofreetomodifyanypartofOctaveanddistributetheirchanges(providedthattheyfollowthetermsoftheGPL).Ibelievethatitisimportantforeveryone,especiallyresearchersandacademics,tohaveaccesstothedetailsofallcomputationstheyperform,sothatitispossiblefortheresultstobereviewedandreproduced.3.2C++asimplementationlanguageOctaveiswritteninamixtureofC++,C,Fortran,andOctave\'sownextensionlanguage.OnlyafewnewfunctionshavebeenimplementedinCorFortran.MostoftheinterpreteriswritteninC++,andIamstillnotsurethatthiswasthebestchoice.WhenIbeganworkonOctaveinearly1992,adraftANSI/ISOstandardforC++wasintheworks(theAnnotatedC++ReferenceManual[5]hadbeenpublishedin1990),butthelanguagewasstillevolving.BecausevendorC++compilersvariedwidelyintheircapabilities,Idecidedthatitwouldbetootowritecodethatcouldbecompiledbyverymanyofthem.Instead,IchosetotrytomakeOctaveworkonlyonthosesystemsthathadworkingportsoftheGNUC++compiler.Thischoicemadeportabilitysomewhateasier,butatamountofwasstillrequiredtokeepuptodateasnewlanguagefeatureswereaddedandsomeoldonesremoved,invalidatingpreviouslyworkingcode.EachnewreleaseoftheGNUC++compilerseemedbothablessingandacurse.IbelievethatusingCinsteadwouldnothavebeenmuchbetter,however,asImuchpreferthefeaturesofC++classesoverwhatisavailableinC,andtheyhavemadememorymanagementeasier.Thestringclassofthestandardlibraryhasbeenquitehelpful,andtemplateshavealsobeenusefulinOctave\'slow-levelarrayclasses.3.3ApplicationlayersOctavehasafairlycleanseparationbetweentheinterpreterandthelibrariesthatimplementthebasicnumericalfunctions.Therearethreemainlayers:ProceedingsofDSC20016Parserandinterpreter,mostlywritteninC++.Thisisbuiltintheformofalibrary(liboctinterp)plusonesmall(about500lines)containingthemainOctaveprogram.Theliboctavelibrary,aC++interfacetonumericalcodeandtoUnixlibraryfunctionsandsystemcalls.ThislibraryprovidesthematrixandarrayclassesforOctaveandpresentsaniceinterfacethathidesdetailssuchasworkar-raysandmanyothermemorymanagementandportabilityproblemsfromtheinterpreter.Thelibcruftlibrary,whichisacollectionofmostlyFortrancodewrittenbyothersthatprovidesmostofthebasenumericalcapability.Ibelievethatthisdivisionisreasonable,butsometwouldnothurt.Forexample,theliboctavelibraryshouldprobablybedividedintoatleasttwoparts,onefornumericaltasksandonefortheoperatingsysteminterface,sothatuserswhoonlywantthenumericalcapabilitieswouldnotalsohavetolinkcodeforcommandlineediting,searching,andPosixfunctionality.Theliboctavelibraryshouldalsobeexaminedandrevisedwhereneededtopresentaconsis-tentinterfaceforprogrammerswishingtoaccessOctave\'sfunctionalityatthislevel.Itmightalsobeusefultoapublicinterfacetotheinterpreterlibraryliboctinterp,sothattheOctaveinterpretercouldmoreeasilybeembeddedinotherapplications.3.4InterpreterimplementationThedesignoftheinterpreterwasoriginallypatternedaftertheGNUshellBash,primarilybecauseIhadthesourcecodeforBashandfounditreasonablyeasytoun-derstand.Theparserconvertssourcecodetoaninternaltreestructure.Functionsarestoredaslistsofstatementsalongwithinformationaboutinputandoutputparametersandlocalsymbols.Theinterpreterevaluatescodebyloopingovertheelementsinalistofstatements,andbyrecursivelyevaluatingnodesinexpressiontrees.ThelexerandparserarewrittenusingFlexandBison,whichmakethemrela-tivelyeasytomodifyandextend.ThereisalsoaC++classinterfacetotheparsetreethatprovidesacleaninterfaceforwalkingthetree.Thisiscurrentlyusedforpretty-printingfunctionsandforsettingbreakpointsforOctave\'sinteractivedebugger.2Usingasimpletree-basedinterpreterseemedeasytoimplementandagoodwayformetomakeitreliable,thoughIsuspectthatitisonereasonthatOctave\'sinterpreterisslow.PaulKienzle,aOctaveuserandcontributor,recentlycomparedOctave\'sper-formanceonaloopoftheformx=[1:100000];total=0;2Thisfeatureiscurrentlyunderdevelopment.ProceedingsofDSC20017SystemCPUTimeMethod(seconds)Octave24.scriptOctave6.9C++usingoperationsonoctave_valueOctave0.032C++usingoperationsonMatrixGuile1.3scriptclisp3.3scriptclisp0.70byte-compiledonloadPython0.73scriptOCAML0.17scriptOCAML0.034compiledscriptGCC0.20unoptimizedGCC0.0060optimizedTable1:PerformanceofOctavecomparedtootherinterpretersandcompilers.fori=1:100000total=total+x(i);endandobtainedtheresultsshowninTable1.Clearly,thereisalotofroomforimprovementintheimplementationofloopsandarrayindexinginOctave.Atthispoint,IbelievethatitmaymakemoresensetomodifyOctave\'sparsertoemitSchemeorsomeothergeneral-purposelanguageforwhichafastinterpreterexists,andthenexecutethecodewithinthatcontextinsteadoftryingtoimprovetheperformanceofOctave\'sinterpreter.ThemotivationwouldbetoimprovethespeedandreliabilityofOctave\'sinterpreterwhileatthesametimereducingtherequiredtomaintainit.Presumably,themaintainersofthegeneral-purposescriptinglanguagewouldbeexpertsininterpreterdesign,whichwouldleaveusmoretimetocontributenumericalfunctionalityinstead.3.5Dynamically-linkedfunctionsAlthoughOctaveisextensibleusingtheOctavelanguage,italsoallowsextensionstobewritteninC++(orothercompiledlanguagesthatcanbecalledfromC++).Usersaregenerallydiscouragedfromwritingextensionsasdynamically-linkedfunctionsunlessacceptableperformancecannotbeachievedusingOctave\'sownextensionlanguage,orthereisaneedtolinktoexistingcompiledcode.Nevertheless,thisisanimportantfeatureforcaseswhenperformanceiscritical,orwhencodealreadyexistsinsomeotherlanguage.3.6ExtensibledatatypesOctavealsoallowsuserstonewdatatypesandloadthematruntimeusingadynamically-linkedfunction.Currently,thenewdatatypemustbebyaC++class,butitwouldbeusefultoprovideawayofdoingthiswithinOctave\'sProceedingsofDSC20018language.TheMatlablanguagenowallowsthecreationofnewdatatypes,butthemethodfordoingsodoesnotseemtobeparticularlywelldesigned,andprobablyshouldnotbecopied.3.7Mixed-typeoperationsBinaryoperationsinOctaveincludemixed-typeoperationsformanydatatypes.Forexample,therearespecialfunctionsforoperationsoncomplexandrealmatrices.Savingmemoryandavoidingunnecessarycopyingoflargeamountsofdataarethemotivationsforprovidingtheseextrafunctionsratherthansimplypromotingtheoperandstoacommontype.Inascalar-basedlanguage,onecantooperationsonsimilartypesonly,becausethecostofconvertinganoperandtothewidertypeissmall.Butwhenworkingwithlargearraysthecostofconvertinganoperandcanbequitelarge.Oneproblemwiththisapproachisthatasnewdatatypesareadded,thereisanexplosioninthenumberofnewfunctionsformixed-typeoperationsthatneedtobeItmaybepossibletogetaroundthisbysomecleveruseoftemplates,butIstillseethisproblemasunsolved.3.8DatatypeconversionOctavecanautomaticallyconvertobjectsofonedatatypetoanotherwhenitseemsreasonabletodoso.OneexampleofthetypeofconversionthatOctavecanperformisanarrowingconversionthatmayhappenatobjectcreation.Forexample,giventhecomplexnumbersx=1+iandy=1-i,thetypeoftheresultoftheexpressionx+ywillbereal,notcomplex.Theconversionhappenswhenthenewobjectthatholdstheresultiscreated.Theresultisoriginallycomplex,buttheconstructorforthecomplexscalarobjectcheckstoseeiftheimaginarypartiszero,andifso,convertstheresulttoarealvalue.Similarconversionscanhappenforcomplexmatrices.Thereissomeoverheadforthesenarrowingconversions,butthereisalsoapotentialbifsubsequentoperationscanbeperformedusinglessexpensiveoperationsonthenarrowertype.Octavealsoperformsallarithmeticindoubleprecision(therearenointegervalueswiththeintegerarithmeticrulesusedinlanguageslikeCorFortran)sointegervaluesareconvertedtodoubleprecisionvalueswhentheyareparsed.Asaconsequence,theexpression1/2producesthevalue0.5,not0.Thistypeofconversionmakessomesense,becausethevalueof1/2isonehalf,notzero.Itwouldbeequallyvalidforthetypeoftheresulttoberationalratherthanadoubleprecision.Itisnotclearwhetherthelackofintegerarithmeticisaseriouslimitation.ItdoesnotseemtobemuchofapracticalproblemforthetypesofprogramsthataretypicallywrittenusingOctave.CurrentlytherearenointegermatricesinOctave,butiftheyareadded,somedesigndecisionsmustbecarefullyconsidered.Forexample,shouldresultsforallbinaryoperationsbeconvertedtodoubles?Iftheresultsareallintegervaluesandnoovwoccurs,itwouldbemorememoryttoreturnanotherintegermatrix.ProceedingsofDSC20019Ifresultoftheoperationsonsomeoftheelementscouldproducenon-integervaluesorovw,thenshouldtheresultsfollowtherulesofintegerarithmeticusedbyotherlanguages(thiswouldbeinconsistentwiththebehaviorforscalars,unlessthoserulesarealsochanged)orshouldtheresultsbedoubleprecisionvalues?Perhapsthesimplestapproachwouldbetodisableallautomaticconversions,andimplementintegerarithmetic.Unfortunately,thismaynotbethemostusefuldesignforthetypicaluserofasystemlikeOctave.3.9ParserproblemsThereareanumberofinparsingtheMatlablanguage.BecauseOc-tavetriestobecompatibleinmanyways,Octave\'sparseristlymorecomplexthatitreallyoughttobe.Bydroppingsomeofthemoreinconsistentlanguagefeatures,Octave\'sparsercouldbemuchsimplerandeasiertounderstandandmaintain.Transposeoperatorandcharacterstrings.Thesinglequotecharacter(\')isusedasthetransposeoperatorandtodelimitstrings,sotheparsermustdoalotofextraworktokeeptrackofwhenthesinglequoteshouldberecognizedasatransposeoperatororwhenitshouldberecognizedasastringdelimiter.Thelanguagewouldbemoreconsistentifthesinglequotecharacterwereusedasatransposeoperatoronly.ThiswouldallowOctave\'sparsertobetlysimplerandalsomakeparsingeasierforhumans.Whitespaceinmatrixlists.Anotherexampleofunnecessaryparsercomplexityisthefeaturethatallowsmatricestobewritten[123]whichisinterpretedasavectorofthreeelements.Forsimplecasesliketheoneabove,thisseemsbutformorecomplexcases,itisambiguous.Forexample,itisnotimmediatelyclearwhether[f(x)-3]shouldbeequivalentto[f,(x),-3](threedistinctelements)or[f(x),-3](twoelements|afunctioncallorindexedarrayfollowedbyascalar)or[f,(x)-3](twoelements|avariable(orfunctioncall,sinceMatlabdoesnotrequirefunctioncallswithnoargumentstobewrittenasf())followedbyabinaryexpression)orProceedingsofDSC200110[f(x)-3](oneelement,theresultofsubtractingascalarfromtheresultofthefunctioncallorindexedarray).Ialsoseenoreasonforthemeaningoftheexpressionf(x)-3tochangewhenitissurroundedbysquarebrackets.Foranyfutureproject,Iwouldhavetheparserignorespacesinsidematrixlistsandrequireseparatorsbetweenelements.Command-stylefunctioncallsyntax.Matlaballowsfunctionstobecalledusingacommand-stylesyntax.Forexample,thefunctionsavecanbecalledusingthesyntaxsave-asciivarorsave("-ascii","var")Bothformsareequivalent.UsersmayalsofunctionsintheMatlablanguagethatmaybecalledthisway.Nospecialfunctiondeclarationisneeded,theonlyrequirementisthatthefunctionbeabletoacceptallargumentspassedasstrings.Althoughthisseemslikeanicefeature,itleadstoaninconsistencythatwouldbebetteravoided.Theproblemisthat,givenafunctioncalledfcn,Matlabwillparsebothofthefollowingstatementsfcn-1fcn-1asasubtractionof1fromthevaluereturnedfromthefunctionfcn,butwillparsefcn-1asacalltothefunctionfcnwiththestringargument"-1",anditwillparsefcn-1asacalltothefunctionfcnwiththestringarguments"-"and"1".Evenworse,Matlabwon\'tallowyoutobypasstheconfusionbywritingf()-1becauseitdoesn\'tallowthisnotationforcallingafunctionwithnoarguments(theMatlabparseremitsanerrorfortheemptypairofparentheses).Ibelievethatthiskindofinconsistencyisunacceptableinaprogramminglan-guage.Forthisreason,Octavedoesnotcurrentlyallowuserstocalltheirownfunctionsusingacommand-stylesyntax,thoughitdoeshavesomespecialbuilt-infunctionsthatmaybecalledthisway(e.g.,load,save,ls,etc.).Thecommand-stylesyntaxisuseful,however,andmanyusersitawkwardtohavetotypethingslikeProceedingsofDSC200111ls("-l""/foo/bar")whentheyareusedtotypingjustls-l/foo/baratashellprompt.Becausethelanguagehassomecommandsthatcanbecalledwithacommand-stylesyntax,itseemsinconsistenttoforbidusersfromtheirownfunctionsthatcanbecalledusingasimilarsyntax.ForanyfutureOctave-likeproject,Iproposerequiringthatfunctioncallsyntax(i.e.,foo("-arg"))beusedinscriptsorfunctionandthenrequiringaofsomesortthatcanbeusedonthecommandlinetointroducecommand-likesyntax.Forexample,somethinglikeoctave:13>M-xls-l/foo/barsimilartothewayEmacsusestheM-x(orESCx)forcallingfunctionsinter-actively.Thissolutionwouldcompletelyavoidtheandwouldnotbemuchhardertotype.Idon\'tbelievethatforcingtheuseoffunctioncallsyntax(i.e.,ls("-l","/foo/bar"))inscriptsandfunctionwouldposemuchofaproblem(itdoesnotseemtobeaproblemforusersofEmacsandEmacsLisp).3.10Built-invariablestocontrolsemanticsTheOctavelanguagehasanumberofbuilt-invariablesthatmaybeusedtocontrolvariousfeaturesoftheinterpreterandeventhelanguage.Insomecasesthesevariablesarerelativelyharmless,butinothers,theycancausettrouble.Amongtheleastharmfulvariablesarethoselikehistory_size,whichspthenumberofcommandlinestosaveinthecommand-linehistoryorPAGER,whichsptheprogramtouseasaforoutputthatisgoingtothescreenininteractivesessions.Variablessuchastheseonlyuserinteractionandcanbesafelyignoredwhenwritingnewfunctionsorscripts.Anothersetofvariablesthebehavioroftheparser.Forexample,thevariablewhitespace_in_literal_matrix,isusedtocontrolthewaythatOctaveparsesmatrixlists.Continuingtheexamplefromtheprevioussection,considerthematrixlist[f(x)-3]Ifthevalueofwhitespace_in_literal_matrixis"ignore",thencommasorsemi-colonsarerequiredtoseparateelementsinthelist,andallwhitespaceisignored.Ifthevalueis"traditional",thenOctaveparsesthecommandasMatlabwould,whichwouldproduce[f,(x),-3](threedistinctelements).Otherwise,Octavewillnottreatspacesbetweenaniden-andanopenparenthesischaracterasanelementseparator(thisisthewayOctaveoriginallybehaved,beforesomeonenoticedthatitwasnotcompatiblewithMatlab).ProceedingsofDSC200112Thevariablewhitespace_in_literal_matrixwasaddedsothatuserscouldchoosewhethertheywantedOctavetoworkasitalwayshad,ortobehaveinaMatlab-compatibleway,ortorequireuserstoexplicitlyseparateelementsinmatrixlists.Unfortunately,thismeansthattowritescriptsthatcanbeinterpretedcorrectlyregardlessofthevalueofthisvariable,onemustavoidspacesbetweenidenandopenparenthesischaracters(orsurroundtheexpressioninanothersetofparenthesis,likethis:(f(x)))andusecommasandsemicolonstoexplicitlyseparateelements.Themostproblematicsetofvariablesrun-timebehavior.MostofthesewereintroducedtoallowcompatibilitywithwhatIbelievedtobemisfeaturesofMatlabwhilealsoallowingOctavetobehaveinamoreconsistentway.Herearetwoexamplesofthistypeofvariable.Thefunctionzerosmaybeusedtocreateamatrixwithzeros.Itcanbecalledinseveraltways.Thesimplestiszeros(n)whichwillcreateasquarematrixwithdimensionnthatiswithzeros.Iftheargumentisarealnumberbutnotaninteger,bothMatlabandOctavesilentlyroundtothenearestinteger.Ifthevalueoftheargumentiscomplex,Matlabsilentlyignorestheimaginarypart,andifitisnegative,Matlabtreatsitaszero.AfterIhadalreadyimplementedthezerosfunctioninOctavewithratherstrictrequirementsfortheargumenttobeaninteger,Inoticedtheseotheroddbehaviorsanddecidedtoallowthem.Inthecaseofnon-integervalues,Iassumed(incor-rectly?)thatitmightbefairlycommonforthedimensionstobecomputedbysomemethodthatwouldproduceanon-integervalue,soIsimplyallowedOc-tavetobehaveasMatlabdoes.Butforthecasesofcomplexandnegativeargu-mentvalues,Idecidedtomakecompatiblebehavioroptionalthroughthevariables.ok_to_lose_imaginary_partandtreat_neg_dim_as_zero.Inowbelievethatthisisanexampleofcompatibilitygonetoofar.Itseemstomethatsimplyrejectinganynon-integerargumentisreasonable.Anyonethatneedstopassacomplex(oranynon-integer)valuetozeros(orsimilarfunctions)coulddosobyexplicitlyconvertingtheargumenttoaninteger.Myguessisthatthiswouldnotcausetroubleformuchexistingcode.3.11Overloadingof()InMatlabandOctave,parenthesesareusedtodelimitargumentlistsforfunctioncallsandindexlistsforarrayindexing.Intheexpressionx(y,z)itisnotimmediatelyclearwhetherthesymbolxisafunctionthatiscalledwithtwoarguments,oranarraythatisindexedbytwovalues.AlthoughthisisvirtuallyimpossibletochangewithoutbreakingnearlyallthecodewrittenforOctaveupuntilnow,itwouldbenicetobeabletodistinguishfunctioncallsfromarrayindexingbysyntaxalone.ProceedingsofDSC2001133.12SyntaxproblemsformatrixlistsThesquarebracketsusedtointroducematrixlistsarelimitedtotwodimensionalmatrices.Originally,Matlabonlyhadtwo-dimensionalmatrices,andarraysofthreeormoredimensionswerenotallowed.EveninthecurrentversionofMatlabthereisapparentlynolist-likesyntaxforintroducingamatrixofmorethantwodimensions.SimilarlimitationsappeartoexistforMatlab\'s\\Cell"datatypeaswell.BecausethematrixlistnotationoccursinmuchofthecodewrittenforOctave,itwouldbequitetoremovethisrestrictionwithoutbreakingmanyexistingprograms.3.13FlatnamespaceOctavehasnogoodwaytocontrolnamespaces.Allfunctionssharethesamenamespace,andarelikely.Matlabdoesallowprivatefunctionswhichareonlyvisibleassubfunctionsinasinglefunctionbutthatseemstoolimited.Ibelievethatpropersupportofnamespaceswouldbeuseful,particularlyasthenumberoffunctionsincreases,thoughitmaynotbeabsolutelynecessaryifsomecareisexercisedbypeoplewritingfunctionsforotherstouse.Emacs,whichhasmanythousandsoffunctionswrittenforitthataresharedbymanypeople,hasnoprovisionfornamespacesotherthansomesuggestednamingconventionsforfunctionsandglobalvariables.3.14GnuplotplotcommandsyntaxOctavehasatightlycoupledinterfacetognuplotthatisimplementedbyduplicatingmuchofthegnuplotcommandsyntaxdirectlyinOctave\'sparser.AtIwasnotsureitwouldevenbepossibletoimplementthisfeatureatallbecauseitseemedtocreatetoomanyintheparser,butIwaseventuallyabletomakeitwork.IbelievethatOctavewouldbebettertodayifIhadfailedandgivenup,butaftersomediscussionswithothers,Iwasconvincedthattheproblemscouldbesolvedwithenoughcode.Unfortunately,Ilackedtheexperiencetoseehowmuchtroubleitwouldreallycause.Obviously,thegnuplot-stylecommandsthatOctaveunderstandsarefairlysim-pletoconvertintocommandsthatcanbepassedtognuplot.Itwouldbemuchmoretoconvertthemintocommandsorsubroutinecallstoanotherplottingpackage,however,soreplacinggnuplotbyanotherplottingpackingisproblematic,becauseitimpliesalargeorbreakingbackwardcompatibility.Probablyitwouldbebesttodropthisfunctionalityinanyfutureproject.4MATLABCompatibilityIssuesIoriginallybelievedthatcompatibilitywithMatlabwasanimportantandrea-sonablegoal(butcertainlynotthemostimportantone).IbelievedthatitwouldhelppeoplebeginusingOctavebymakingiteasiertolearnandbymakingitpos-sibleforthemtousecodetheyhaddevelopedforMatlabwithouthavingtomakeProceedingsofDSC200114substantialchanges.Unfortunately,attemptingtoprovidegoodMatlabcompati-bilityhasalsocausedmanyproblemsanddivertedresourcesawayfromimprovingthecapabilitiesofOctaveinothermoreimportantareas.BecauseofitsclosecompatibilitywithMatlab,OctaveattractedmanyMat-labusers.Somefoundfeaturesthatwerenotsupported,orbehaviorsthatwereinconsistent,andreportedthemasbugs.Theseproblemreportswereoftengivenarelativelyhighpriority,particularlywhentheproblemswereeitherminororseemedgratuitous.AlthoughIdidnotintendto,IbelievethatbytheseproblemsandmakingOctaveevenmorecompatiblewithMatlab,IencouragedpeopletothinkthataprimarygoalwastocreateanexactreplicaofMatlab.Inolongerbelievethatcompatibilityisareasonablegoal.Itinnovationandplacestheprojectinthepositionofneverbeingaleader,alwaysbeingafollower,andquitefarbehindalmostallthetime.Ifcompatibilityisagoal,almostnoinnovationisallowed,becausethereisthepotentialforanynewfeaturetobeincompatiblewithfutureversionsofMatlab.(Thisisnotjustanimaginedproblem|ithashappenedinthepast,andIexpectitwillhappenagain.)Whenincompatibilitieslikethisarise,thereareseveralchoices.OneistoaddthenewMatlab-compatiblefeatureandstillsupporttheoldwaytoo.Evenifthisispossible(itmaybethatthefeaturessimplycannotcoexist),itaddsadditionalmaintenancecostsbecauseonemustnowsupporttwotwaysofdoingessen-tiallythesamething.Anotherchoiceistoadoptthenewwayanddroptheold,butbreakingbackwardcompatibilityisusuallyseenasundesirable.Ignoringthenewfeatureisalsopossible,buttendstoresultinbugreportsaskingwhythereisanincompatibility(typicallytheassumptionseemstobethatwhoeverimplementedtheOctavefeaturesomehowgotitwrong).Decidingthatitwouldbebesttoavoidinnovationandfocusoncompletecom-patibilityisalsoapathtochoose.Becausethereisnostandardforit,theoftheMatlablanguageiswhateverbehaviorthecurrentversionofMatlabhappenstoexhibit.Attemptingcompatibilityrequiresfollowingamovingtarget,andbecauseTheMathWorksalmostneveropenlydiscusstheirdevelopmentplansinadvanceofnewreleases,thecompatibilitywillbeyearsbehindateachnewreleaseofthetargetsystem.Therearealsosomenon-technicalproblemsassociatedwithstrivingforcompat-ibilitywithasystemlikeMatlab.IbelievethatmanypeoplehavestartedusingOctavebecausetheyseeitasa\\Matlabclone"availablefreeofchargeratherthanafreelyavailablesystemfordoingusefulwork.Often,theseusershaveassumedtheroleof\\customers"whowouldaskforhelp,abugoranewfeature,thenwaitforasolutioninsteadofcontributing.Idon\'tbelievethatthistypeofbehavioristhenormamongsuccessfulfreesoftwareprojects.Indeed,Ibelievethatforafreesoftwareprojecttobesuccessful,itmusthavemanycompetentuserswhoalsofunctionintheroleofdevelopers.Althoughtherehavebeensometcon-tributions,Octavehasneverdevelopedastrongcoreofdedicatedandcompetentdevelopers.ProceedingsofDSC2001155FutureImmediateplansforOctaveincludethereleaseofanew\\stable"versionthatIwillmaintaintoseriousbugsonly.IfpeopleareinterestedinhavingsomeformofOctavecontinuealongitspreviousdevelopmentpath,theywillneedtoorganizethatyfocusisnowonfuturedirections.AlthoughIwillnotbeworkingmuchwithOctaveasitiscurrentlyimplemented,thefuturemayinvolveaderivativeofOctave.IftheproblemsdescribedinSection3areinthewaysthatIhaveproposed,IbelieveOctavewillprovideamuch-improvedlanguage.ItwillremainsimilartoMatlab,butincompatible.Itwillbeeasyforusersofonelanguagetounderstandtheother,but,inmostcases,tosharecodebetweenthetwosystems.Ifthesechangesaremade,Icanseetadvantagesanddisadvantages.Onthepositiveside,wewillhaveamoreconsistentlanguageandaninterpreterthatiseasiertomaintain,andtherewillbelesswastedontheimplementationofpoorlydesignedfeaturesjusttohavecompatibility.Somepossibledisadvantagesarethatpeoplewillgenerallyhavetochooseonesystemortheother,welosesomeuserswhoseecompatibilityasanabsolutemust,andweinventyetanotherscriptinglanguage.AnotherpossibilityforthefutureistoleavetheOctavelanguagealoneandfocusingonadditionalfeatures(sparsematrices,parallelism,etc.)whilefendingtherequestsforadditionalMatlabcompatibility.ButaslongasOctaveisgenerallycompatible,usersarelikelytocontinuetowantmore,andIwouldpreferacleanbreakfromthisproblem.Ifitisundesirabletoinventyetanotherscriptinglanguage,thenperhapsitwouldbebesttosimplychooseanothergeneralpurposescriptinglanguagethatalreadyexistsandaddthenumericalfeaturesfromOctavetoit.IwasaskedaboutamergerofthistypeforOctaveandPython,butasIexaminedPythonmoreclosely,Idecidedthatitdidnotseemtobewell-suitedfornumericalcomputing(thoughmanyseemtobeusingitforthatpurposeanyway).Otherpopularscriptinglanguageshavesimilarproblems.Atthispoint,I\'mleaningmoretowardastreamlinedOctavebuiltontopofsomefastergeneral-purposescriptinglanguagesuchasGuile,theGNUproject\'sembeddableSchemeinterpreter.ThiswouldpreservethesyntaxofOctave(whichseemstobereasonablygoodforexpressingnumericalalgorithms)andallowaccesstothecapabilitiesofthemoregeneralpurposelanguage.ReasonsforchoosingGuilearethatitisintendedtobeusedasanembeddedinterpreter,anditshouldnotbetoototranslateOctavetoScheme.6FinalCommentsSomecommentsinthispaper(particularlythoserelatedtotheproblemswithMat-labcompatibility)mayseemquitepessimistic,butIdon\'tthinkthatthesituationishopeless.ThoseofuswhocareaboutfreesoftwaretoolslikeOctaveshouldseektoavoidtheseproblemsbynotmakingcompatibilitywithproprietarysoftwareaprimarygoal,particularlyifdoingsocomesataverylargecost.Wemustbe-ProceedingsofDSC200116comeleadersratherthanfollowersanddevelopavisionbeyondreimplementationofexistingproprietarytools.Tobesuccessful,aprojectlikeOctaveneedstohavemanycontributorsalignedwithacommongoal.Iwouldliketoseethatgoalbeafreelyavailable,highqualitysystemfornumerical(andpossiblysymbolic)computationsthatinspirespeopletocontributeinnovativeideasandcode.References[1]E.Anderson,Z.Bai,C.Bischof,J.Demmel,J.Dongarra,J.DuCroz,A.Green-baum,S.Hammarling,A.McKenny,S.Ostrouchov,andD.Sorensen.LAPACKUsers\'Guide.SIAM,Philidelphia,1992.[2]JackJ.Dongarra,JeremeyDuCroz,SvenHammarling,andIainAsetoflevel3basiclinearalgebrasubprograms.ACMTransactionsonMathematicalSoftware,16(1):1{17,1990.[3]JackJ.Dongarra,JeremyDuCroz,SvenHammarling,andRichardJ.Han-son.AnextendedsetofFORTRANbasiclinearalgebrasubprograms.ACMTransactionsonMathematicalSoftware,14(1):1{17,March1988.[4]DirkEddelbuettel.EconometricswithOctave.JournalofAppliedEconomet-rics,15:531{542,2000.[5]MargaretA.EllisandBjarneStroustrup.TheAnnotatedC++ReferenceMan-ual.Addison-Wesley,Reading,MA,1990.[6]AlanC.Hindmarsh.ODEPACK,asystematizedcollectionofODEsolvers.InR.S.Stepleman,editor,Computing,pages55{64,Amsterdam,1983.North-Holland.[7]C.L.Lawson,R.J.Hanson,D.R.Kincaid,andF.T.Krogh.BasiclinearalgebrasubprogramsforFortranusage.ACMTransactionsonMathematicalSoftware,5(3):308{323,September1979.[8]OctaveLevenspiel.ChemicalReactionEngineering.JohnWileyandSons,NewYork,2ndedition,1972.[9]JorgeJ.More,BurtonS.Garbow,andKennethE.Hillstrom.Userguideforminpack-1.TechnicalReportANL{80{74,ArgonneNationalLaboratory,March1980.[10]MalcolmMurphy.Octave:Afree,high-levellangaugeformathematics.LinuxJournal,July1997.[11]L.R.Petzold.AdescriptionofDASSL:Atial-algebraicsystemsolver.InR.S.Stepleman,editor,Computing,pages65{68,Amsterdam,1983.North-Holland.ProceedingsofDSC200117[12]EricS.Raymond.Thecathedralandthebazaar.Webdocument,availablefromhttp://www.tuxedo.org/~esr/writings/cathedral-bazaar,1997.'
>>> f=File(open('foo.txt'))
>>> extractText(f)
' P Lakshmi Narasimhan\n\n\nCareer Profile\n\n\n        Seeking a challenging position that leverages my experience and also provides opportunities for professional and personal growth.\n\n\nAreas of interest\n\n\n    *\n\n      usability focus of various programming languages\n    *\n\n      C++ standardization\n    *\n\n      Software engineering practices and dynamics of open source projects\n\n\nTechnical skills\n\n\n    *\n\n      I feel at home in a linux environment.working experience in UNIX variants like AIX, HP-UX and Windows based systems. Strong exposure to the GNU toolchain, UNIX-ish tools like awk, sed and shell scripts.\n    *\n\n      good knowledge of C and C++. This involves:\n          o finding out a bug and patching it in considerable time for a medium to large sized software system.\n          o knowledge of STL.\n\n\n    * proficiency in python. This involves:\n          o scripting all odd tasks which cannot be done using C/C++ or which do not have any performance constraints\n          o quick prototyping\n          o experience in the Django web framework\n\n\n    * TTCN-3\n    * javascript, jquery\n\n    * sparing knowledge of verilog and lisp.\n    * software tools : subversion, Rational Clearcase, Microsoft VSS, GNU Make, Trac.\n\n\nEducational Qualification\n\n\n    *\n\n      B.Tech in Electronics and Communication engineering, SASTRA, Tanjavur, India, year of passing June 2006. GPA - 7.5/10.0.\n\n\nProfessional Experience Summary\n\n\nEmployer: Huawei\n\nDesignation: software engineer\n\nPeriod: July 2006 till date\n\nwe are designing a distributed platform which provides system level services for telecom applications. We mostly work on C++ and implement storage facility, high availability, adapters, CORBA based request brokers and telecom service life cycle management.\nOccasionally shell and python are used for odd scripting jobs.\nTechnologies used: Sqlite, distributed programming APIs in C++ similar to ACE, python, CORBA like proprietary system.\n\n\n   1. I work as a developer and tester of a telecom product dubbed ENIP.\n   2. It is a layer on top of the operating system which serves as a playground for various telecom services to run.\n   3. I work on the development of core services of ENIP. It involves various concepts of distributed programming like data persistence and synchronization(using sqlite), multi-threading etc.\n   4. I got a product consciousness award in 2007 for automating the build system(using python) and writing a program which automatically inserts debug logs in a C++ file(using C++).\n\n\nOrganization: SASTRA Linux User Group\n\nDesignation: Coordinator\n\nPeriod: June 2003 to May 2006\n\n   1. I was the Linux User Group coordinator of my college and my main activity was to advocate the use of Linux in the campus.\n   2. It involved giving a series of presentations and lectures during weekends on various technical and non technical aspects of Linux and open source.\n\n\n        contribution to various open source projects like django(www.djangoproject.com) and openc++ MOP(opencxx.sf.net).\n\n\nPersonal information\n\n\n    *\n\n      Email: badri DOT dilbert AT gmail DOT com\n    *\n\n      Snail mail: 82/1, Annayappa Garden, New Tippsandra, Bangalore-75.\n    *\n\n      Phone : 9986040652.\n\n'
>>> a=File(open('get_profile_alt.py'))
>>> extractText(a)
Traceback (most recent call last):
  File "<stdin>", line 1, in <module>
  File "/opt/git-repos/django-profile/utils/fileFilter.py", line 29, in extractText
    raise InvalidFileExtension(f.name, ext)
utils.fileFilter.InvalidFileExtension
"""
